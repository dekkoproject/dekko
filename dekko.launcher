#!/bin/bash

if [ "$SNAP_ARCH" == "amd64" ]; then
	ARCH="x86_64-linux-gnu"
elif [ "$SNAP_ARCH" == "armhf" ]; then
	ARCH="arm-linux-gnueabihf"
else
	ARCH="$SNAP_ARCH-linux-gnu"
fi

# Disable the chromium sandbox to work around https://launchpad.net/bugs/1599234.
# Rely on snapdâ€™s security policy instead.
export OXIDE_NO_SANDBOX=1

# Explicitly set APP_ID.
export APP_ID=dekko

# plugins - plugins in these dirs are loaded on demand at runtime
export QMF_PLUGINS=$SNAP/usr/lib/$ARCH/qmf/plugins5
export DEKKO_PLUGINS=$SNAP/usr/lib/$ARCH/Dekko/plugins

echo "LD_LIBRARY_PATH: $LD_LIBRARY_PATH"
echo "QML2_IMPORT_PATH: $QML2_IMPORT_PATH"

exec $SNAP/usr/bin/dekko --desktop_file_hint=unity8 "$@"
